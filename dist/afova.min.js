"use strict";import{nanoid as F}from"nanoid";import h from"./locale/en.json";import V from"./locale/de.json";const U=["text","email","datetime-local","file","image","month","number","password","range","search","tel","time","url","week"],G=["required","pattern","max","min","step","maxlength","minlength","type"],j=["badInput","customError","patternMismatch","rangeOverflow","rangeUnderflow","stepMismatch","tooLong","tooShort","typeMismatch","valueMissing"],R={selector:"form",validateOnChange:!1,focusOnFirstError:!0},u={en:h,de:V},w=["submit","reset","button"];function k(){let a=navigator.language,s=u[a];if(s)return console.log(`afova is using locale=[${a}]`),s;const l=a.indexOf("-");return l&&(a=a.substring(0,l),a&&(s=u[a])),s?(console.log(`afova is using language=[${a}]`),s):(console.log("afova is using language=[en]"),u.en)}export function afova(a){let s=k();function l(e){e.id||(e.id=`afova-${F()}`)}function d(e){return document.querySelector(`#${e.id}-afova-message-container`)}function p(e){let t=d(e);return t||(t=document.createElement("ul"),e.parentNode?.insertBefore(t,e),t.id=`${e.id}-afova-message-container`,t.classList.add("afova-message-container"),e.setAttribute("aria-errormessage",t.id)),t}function b(e,t){if(e!="customError"){let n=s[e];if(n){let o=n.constraint,i=t.dataset[o||e]||s[e][t.type]||n.message;const f=t.getAttribute(o||"");if(f){const N=new RegExp("{{\\s*constraint\\s*}}","ig");i=i.replace(N,f)}return i}}return t.validationMessage}function C(e){const t=p(e),n=e.validity,o=document.createElement("li");o.classList.add("afova-message"),t.appendChild(o);for(const i of j)if(n[i]){let f=b(i,e);f&&(o.innerHTML=f);break}o.innerHTML||(o.innerHTML=e.dataset.errorInvalid||s.badInput.message)}function v(e){e.removeAttribute("aria-invalid"),e.removeAttribute("aria-errormessage");const t=d(e);t&&t.remove();let n=m(e);n&&n.classList.remove("afova-active")}function O(e,t){const n=m(e);n&&n.classList.add("afova-active"),e.setAttribute("aria-invalid","true"),C(e),t&&e.focus()}function g(e,t){return v(e),e.validity.valid||O(e,t),e.validity.valid}function c(e){const t=[];for(const n of e.elements)w.includes(n.type)||t.push(n);return t}function E(e,t){let n;for(const o of c(e)){const i=g(o);!n&&!i&&(n=o)}n&&(t?.preventDefault(),r.focusOnFirstError&&n.focus())}function _(e){for(let t of c(e))v(t)}function A(){const e=document.querySelectorAll(r.selector||"form");for(const t of e){t.setAttribute("novalidate",""),l(t),t.addEventListener("submit",L),t.addEventListener("reset",T);for(const n of c(t))y(n)}}function L(e){E(e.target,e)}function T(e){_(e.target)}function H(){const e=document.querySelectorAll(r.selector||"form");for(const t of e){t.removeAttribute("novalidate"),t.removeEventListener("submit",L),t.removeEventListener("reset",T);for(const n of c(t))I(n)}}function y(e){l(e),m(e),e.classList.add("afova-control"),r.validateOnChange&&e.addEventListener("change",M)}function M(e){g(e.target,!0)}function I(e){e.classList.remove("afova-control"),e.removeEventListener("change",M)}function m(e){let t=e.closest(".afova-context");return t||(t=e.closest("label")),t&&(t.classList.add("afova-context"),t.tagName=="LABEL"&&!t.htmlFor&&(t.htmlFor=e.id)),t}function S(){const e=document.querySelectorAll(r.selector||"form");for(const t of e)E(t)}function x(){const e=document.querySelectorAll(r.selector||"form");for(const t of e)if(!t.checkValidity())return!0;return!1}let r=Object.assign({},R,a);return A(),{clear:()=>H(),validate:()=>S(),isInvalid:()=>x()}}
//# sourceMappingURL=afova.min.js.map
